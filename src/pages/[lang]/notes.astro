---
import type { GetStaticPaths } from 'astro'

import { getCollection } from 'astro:content'

import Container from '@/components/container.astro'
import TypographyH1 from '@/components/typography/TypographyH1.astro'
import { getLocale, t } from '@/i18n'
import BaseLayout from '@/layouts/base-layout.astro'

export const getStaticPaths = (async () => [
  { params: { lang: 'ru' } },
  { params: { lang: 'en' } }
]) satisfies GetStaticPaths

const notes = await getCollection('notes', entry => {
  return entry.slug.startsWith(`${getLocale(Astro.currentLocale)}/`)
})

const getNoteUrl = (slug: string): string => {
  return `/${Astro.currentLocale}/notes/${slug.split('/')[1]}`
}
---

<BaseLayout title=`${t(Astro.currentLocale, 'notes')} â€“ ${t(Astro.currentLocale, 'fullName')}`>
  <Container class="notes-container">
    <TypographyH1>{t(Astro.currentLocale, 'notes')}</TypographyH1>
    <ul>
      {
        notes.map(note => (
          <>
            <li>
              <a href={getNoteUrl(note.slug)}>{note.data.title}</a>
            </li>
          </>
        ))
      }
    </ul>
  </Container>
</BaseLayout>

<style>
  @import '../../styles/mixins.css';
  @import '../../styles/media.css';

  .notes-container {
    --max-width: 800px;

    padding-top: 3rem;
  }
</style>
