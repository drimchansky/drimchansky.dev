---
import { getRelativeLocaleUrl } from 'astro:i18n'

import { getLocale, t } from '@/app/i18n'
import GlobeIcon from '@/shared/assets/icons/globe.svg'
import { getTestId } from '@/shared/functions/getTestId'
import TypographySpan from '@/shared/ui/typography/typography-span.astro'

const locale = getLocale(Astro.currentLocale)
const toLocale = locale === 'en' ? 'ru' : 'en'

const pathname = Astro.url.pathname.replace(`/${locale}`, '')
---

<a
  data-testid={getTestId('lang-switch-link')}
  class="lang-switch-link"
  href={getRelativeLocaleUrl(toLocale, pathname)}
  hreflang={toLocale}
  rel="alternate"
  data-prefetch
>
  <GlobeIcon class="lang-switch-link__icon" />
  <TypographySpan>{t(Astro.currentLocale, 'toLocale')}</TypographySpan>
</a>

<style>
  @import '@/app/styles/mixins.css';

  .lang-switch-link {
    @mixin focus;

    display: flex;
    align-items: center;
    padding: 0.5rem;
    color: var(--c-menu-link-text);
    gap: 0.5rem;
    text-decoration: none;
    transition: color var(--link-hover-duration);

    @media (hover: hover) {
      &:hover,
      &:hover span {
        color: var(--c-menu-link-text-hover);
      }
    }
  }

  .lang-switch-link__icon {
    width: 1rem;
    height: 1rem;
  }
</style>
